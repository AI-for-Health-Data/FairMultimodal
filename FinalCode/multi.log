Using device: cuda

--- Debug Info: Before Merge ---
Structured data shape: (33942, 39)
Unstructured data shape: (33942, 1053)
After filtering, number of rows: 33701
Computing aggregated text embeddings for each patient...
Aggregated text embeddings shape: (33701, 768)
Column FIRST_WARDID_struct not found; creating default values.
Column LAST_WARDID_struct not found; creating default values.

--- Hyperparameters based on processed data ---
NUM_DISEASES: 33701
NUM_AGES: 75
NUM_SEGMENTS: 2
NUM_ADMISSION_LOCS: 1
NUM_DISCHARGE_LOCS: 1
NUM_GENDERS: 2
NUM_ETHNICITIES: 41
NUM_INSURANCES: 5
[Epoch 1] Train Loss: 1.1273
Metrics at threshold=0.5 after epoch 1: {'mortality': {'aucroc': 0.9448897019579521, 'auprc': 0.7396818974519906, 'f1': 0.4361417700692397, 'recall': 0.9538230884557721, 'precision': 0.282705296836118}, 'readmission': {'aucroc': 0.6947891057999456, 'auprc': 0.17822141204489078, 'f1': 0.20262180798666363, 'recall': 0.884844473858372, 'precision': 0.11441040561355469}}
[Epoch 2] Train Loss: 1.0214
Metrics at threshold=0.5 after epoch 2: {'mortality': {'aucroc': 0.9551466313869345, 'auprc': 0.7754051383237655, 'f1': 0.5689961642810366, 'recall': 0.9118440779610195, 'precision': 0.4135164536306772}, 'readmission': {'aucroc': 0.7106147160897446, 'auprc': 0.19223997299156093, 'f1': 0.19538397560299417, 'recall': 0.9328259430840503, 'precision': 0.10911976465123481}}
[Epoch 3] Train Loss: 0.9906
Metrics at threshold=0.5 after epoch 3: {'mortality': {'aucroc': 0.9611254588078416, 'auprc': 0.7955126554877717, 'f1': 0.6572950912594944, 'recall': 0.8692653673163419, 'precision': 0.5284360189573459}, 'readmission': {'aucroc': 0.7182868456487232, 'auprc': 0.20170944905948443, 'f1': 0.21155806476907393, 'recall': 0.8927862342819325, 'precision': 0.11999644191425013}}
[Epoch 4] Train Loss: 0.9678
Metrics at threshold=0.5 after epoch 4: {'mortality': {'aucroc': 0.964856304311784, 'auprc': 0.8088097252251781, 'f1': 0.5252225519287834, 'recall': 0.9553223388305847, 'precision': 0.36216892122314426}, 'readmission': {'aucroc': 0.7299221433597904, 'auprc': 0.21275534610794222, 'f1': 0.2157394843962008, 'recall': 0.8944407677035076, 'precision': 0.12266291522962425}}
[Epoch 5] Train Loss: 0.9500
Metrics at threshold=0.5 after epoch 5: {'mortality': {'aucroc': 0.9676877230225036, 'auprc': 0.8195887521919033, 'f1': 0.6845903165735568, 'recall': 0.8818590704647676, 'precision': 0.5594445501236447}, 'readmission': {'aucroc': 0.7377164200795803, 'auprc': 0.2184049638197534, 'f1': 0.2413286302175191, 'recall': 0.815023163467902, 'precision': 0.1416331224841863}}
Training complete.

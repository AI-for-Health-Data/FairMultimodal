Using device: cuda

--- Debug Info: Before Merge ---
Structured data shape: (36615, 39)
Unstructured data shape: (46476, 1053)
After filtering, number of rows: 32721
Computing aggregated text embeddings for each patient...
Aggregated text embeddings shape: (32721, 768)
Column FIRST_WARDID_struct not found; creating default values.
Column LAST_WARDID_struct not found; creating default values.

--- Hyperparameters based on processed data ---
NUM_DISEASES: 32721
NUM_AGES: 75
NUM_SEGMENTS: 2
NUM_ADMISSION_LOCS: 1
NUM_DISCHARGE_LOCS: 1
NUM_GENDERS: 2
NUM_ETHNICITIES: 41
NUM_INSURANCES: 5
[Epoch 1] Train Loss: 1.1702
Metrics at threshold=0.5 after epoch 1: {'mortality': {'aucroc': 0.9390953861602922, 'auprc': 0.7437007500231813, 'f1': 0.435352078827205, 'recall': 0.9615180467091295, 'precision': 0.2813762037899969}, 'readmission': {'aucroc': 0.7076237971214725, 'auprc': 0.10933006851525418, 'f1': 0.11587449518484001, 'recall': 0.9192852741836106, 'precision': 0.06183430726511666}}
[Epoch 2] Train Loss: 1.0614
Metrics at threshold=0.5 after epoch 2: {'mortality': {'aucroc': 0.9496317857340065, 'auprc': 0.7721103495826749, 'f1': 0.48234822144958545, 'recall': 0.957271762208068, 'precision': 0.32239899892742224}, 'readmission': {'aucroc': 0.7169219822121763, 'auprc': 0.11641885246763331, 'f1': 0.11428571428571428, 'recall': 0.9476278496611213, 'precision': 0.0608097422109758}}
[Epoch 3] Train Loss: 1.0348
Metrics at threshold=0.5 after epoch 3: {'mortality': {'aucroc': 0.9550694366072315, 'auprc': 0.7922688866562573, 'f1': 0.5875887724044639, 'recall': 0.92223991507431, 'precision': 0.4311414392059553}, 'readmission': {'aucroc': 0.7188006356943588, 'auprc': 0.1185994981561608, 'f1': 0.13968626614021984, 'recall': 0.8065311152187308, 'precision': 0.07646474677259185}}
[Epoch 4] Train Loss: 1.0135
Metrics at threshold=0.5 after epoch 4: {'mortality': {'aucroc': 0.9567086653286756, 'auprc': 0.7940572726812565, 'f1': 0.5145582686694667, 'recall': 0.9591295116772823, 'precision': 0.35159062165580307}, 'readmission': {'aucroc': 0.7298378227285935, 'auprc': 0.11806361930564022, 'f1': 0.1494653649465365, 'recall': 0.7923598274799754, 'precision': 0.08251523901187038}}
[Epoch 5] Train Loss: 0.9971
Metrics at threshold=0.5 after epoch 5: {'mortality': {'aucroc': 0.9611035223056799, 'auprc': 0.810436899043174, 'f1': 0.6278051450465244, 'recall': 0.9132165605095541, 'precision': 0.47831526271893243}, 'readmission': {'aucroc': 0.7407691888267516, 'auprc': 0.1300500420841086, 'f1': 0.137431839019447, 'recall': 0.8773875539125077, 'precision': 0.07455497382198953}}
Training complete.
